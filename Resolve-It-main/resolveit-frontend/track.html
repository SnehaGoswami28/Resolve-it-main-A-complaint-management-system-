<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>ResolveIt - Track Status</title>
</head>
<body>
    <header>
        <h1>Track Your Complaint Status</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
            
                <li><a href="track.html">Track Status</a></li>
            </ul>
        </nav>
    </header>

    <section id="track-status">
        <h2>Track Your Complaint Status</h2>
        <div class="status-form">
            <label for="trackingId">Enter Mail</label>
            <input type="email" id="trackEmail" placeholder="Enter your email" required>
            <button id="trackButton" class="track-button">Track Status</button>
        </div>
        <div id="statusResult" class="status-result"></div>
        <div class="container">
            <h2 class="title">Complaint Status</h2>
            <div class="timeline">
                <div class="step completed">
                    <div class="circle">1</div>
                    <div class="content">
                        <h3>Submitted</h3>
                        <p>Your complaint has been received.</p>
                    </div>
                </div>
    
                <div class="step completed">
                    <div class="circle">2</div>
                    <div class="content">
                        <h3>Under Review</h3>
                        <p>The admin team is checking the complaint details.</p>
                    </div>
                </div>
    
                <div class="step active">
                    <div class="circle">3</div>
                    <div class="content">
                        <h3>In Progress</h3>
                        <p>The issue is assigned to the responsible department.</p>
                    </div>
                </div>
    
                <div class="step">
                    <div class="circle">4</div>
                    <div class="content">
                        <h3>Resolved</h3>
                        <p>The problem has been fixed.</p>
                    </div>
                </div>
    
                <div class="step">
                    <div class="circle">5</div>
                    <div class="content">
                        <h3>Closed</h3>
                        <p>The complaint is completed and archived.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    


    <script>async function trackComplaint() {
  const email = document.getElementById("trackEmail").value;

  try {
    const res = await fetch(`http://localhost:5001/api/complaints/track/${email}`);
    const complaints = await res.json();

    let html = "<h3>Your Complaints:</h3><ul>";
    complaints.forEach(c => {
      html += `<li><b>${c.category}</b>: ${c.description} - <b>Status: ${c.status}</b></li>`;
    });
    html += "</ul>";

    document.getElementById("complaintList").innerHTML = html;
  } catch (err) {
    alert("Error tracking complaint");
    console.error(err);
  }
}
</script>
</body>
</html>